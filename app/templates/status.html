<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµ±ä¸€ç›´æ’­ç›£æ§æ©Ÿå™¨äºº (æ—¥æœ¬æ™‚é–“)</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– çµ±ä¸€ç›´æ’­ç›£æ§æ©Ÿå™¨äºº</h1>
            <p>Instagramç›£æ§ + Discordé »é“ç›£æ§ + é›»è©±é€šçŸ¥</p>
            <div class="time-display">
                <div class="japan-time">ğŸ• æ—¥æœ¬æ™‚é–“: <span id="japanTime">{{japanTime}}</span></div>
                <div class="time-slot">{{timeSlot}}</div>
            </div>
        </div>

        {{#unless isMonitoring}}
        <div class="system-warning">
            âš ï¸ Instagramç›£æ§ç³»çµ±æ­£åœ¨åˆå§‹åŒ–ä¸­ï¼Œè«‹ç¨ç­‰...
        </div>
        {{/unless}}

        <div class="live-indicator {{#if isLiveNow}}live-yes{{else}}live-no{{/if}}">
            {{#if isLiveNow}}
                ğŸ”´ @{{targetUsername}} æ­£åœ¨ç›´æ’­!
            {{else}}
                âš« @{{targetUsername}} é›¢ç·šä¸­
            {{/if}}
        </div>

        <div class="main-status">
            <div class="status-card {{#unless botReady}}error{{/unless}}">
                <div class="card-title">ğŸ¤– Botç‹€æ…‹</div>
                <div class="status-item">
                    <span>é€£ç·šç‹€æ…‹:</span>
                    <span class="status-value">{{#if botReady}}âœ… åœ¨ç·š{{else}}âŒ é›¢ç·š{{/if}}</span>
                </div>
                <div class="status-item">
                    <span>é‹è¡Œæ™‚é–“:</span>
                    <span class="status-value">{{uptimeHours}}h {{uptimeMinutes}}m</span>
                </div>
                <div class="status-item">
                    <span>æ—¥æœ¬æ™‚é–“:</span>
                    <span class="status-value">{{japanHour}}:xx</span>
                </div>
                <div class="status-item">
                    <span>ä¼ºæœå™¨æ•¸:</span>
                    <span class="status-value">{{guildCount}}</span>
                </div>
            </div>

            <div class="status-card {{#unless isMonitoring}}warning{{/unless}}">
                <div class="card-title">ğŸ“º Instagramç›£æ§</div>
                <div class="status-item">
                    <span>ç›®æ¨™ç”¨æˆ¶:</span>
                    <span class="status-value">@{{targetUsername}}</span>
                </div>
                <div class="status-item">
                    <span>ç›£æ§ç‹€æ…‹:</span>
                    <span class="status-value">{{#if isMonitoring}}âœ… é‹è¡Œä¸­{{else}}âŒ å·²åœæ­¢{{/if}}</span>
                </div>
                <div class="status-item">
                    <span>å¯ç”¨å¸³è™Ÿ:</span>
                    <span class="status-value">{{availableAccounts}}/{{totalAccounts}}</span>
                </div>
                <div class="status-item">
                    <span>å¤±æ•ˆå¸³è™Ÿ:</span>
                    <span class="status-value {{#if invalidCookieAccounts}}error{{/if}}">{{invalidCookieAccounts}}</span>
                </div>
                <div class="status-item">
                    <span>ä»Šæ—¥è«‹æ±‚:</span>
                    <span class="status-value">{{dailyRequests}}/{{maxDailyRequests}}</span>
                </div>
            </div>

            <div class="status-card">
                <div class="card-title">ğŸ“‹ Discordç›£æ§</div>
                <div class="status-item">
                    <span>ç›£æ§é »é“:</span>
                    <span class="status-value">{{discordChannelCount}}</span>
                </div>
                <div class="status-item">
                    <span>è™•ç†è¨Šæ¯:</span>
                    <span class="status-value">{{totalMessagesProcessed}}</span>
                </div>
                <div class="status-item">
                    <span>æª¢æ¸¬æ¬¡æ•¸:</span>
                    <span class="status-value">{{totalDetections}}</span>
                </div>
            </div>

            <div class="status-card">
                <div class="card-title">ğŸ“ é€šçŸ¥çµ±è¨ˆ</div>
                <div class="status-item">
                    <span>Discordè¨Šæ¯:</span>
                    <span class="status-value">{{discordMessages}}</span>
                </div>
                <div class="status-item">
                    <span>é›»è©±é€šçŸ¥:</span>
                    <span class="status-value">{{phoneCallsMade}}</span>
                </div>
                <div class="status-item">
                    <span>æœ€å¾Œé€šçŸ¥:</span>
                    <span class="status-value">{{lastNotification}}</span>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ”‘ å¸³è™ŸCookieç‹€æ…‹ (æ—¥æœ¬æ™‚é–“)</div>
            <div id="cookieStatus">
                {{> cookieStatus}}
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ“Š è©³ç´°çµ±è¨ˆ</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-number">{{totalRequests}}</div>
                    <div class="stat-label">Instagram è«‹æ±‚ç¸½æ•¸</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{consecutiveErrors}}</div>
                    <div class="stat-label">é€£çºŒéŒ¯èª¤æ¬¡æ•¸</div>
                </div>
                <div class="stat-box {{#if invalidCookieAccounts}}error{{/if}}">
                    <div class="stat-number">{{invalidCookieAccounts}}</div>
                    <div class="stat-label">å¤±æ•ˆå¸³è™Ÿ</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{discordChannelCount}}</div>
                    <div class="stat-label">Discord é »é“æ•¸</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{apiAccountCount}}</div>
                    <div class="stat-label">PushCall API å¸³è™Ÿ</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{japanHour}}</div>
                    <div class="stat-label">ç•¶å‰æ—¥æœ¬æ™‚é–“ (æ™‚)</div>
                </div>
            </div>
        </div>

        {{#if totalAccounts}}
        <div class="section">
            <div class="section-title">ğŸ” Instagram å¸³è™Ÿç‹€æ…‹ (æ—¥æœ¬æ™‚é–“)</div>
            <div class="rotation-info">
                <div class="rotation-strategy">
                    ğŸ”„ <strong>è¼ªæ›ç­–ç•¥:</strong> æ¯å€‹å¸³è™Ÿä½¿ç”¨8æ¬¡å¾Œå¼·åˆ¶è¼ªæ›ï¼Œå†·å»30åˆ†é˜
                </div>
                <div class="current-account">
                    ğŸ“ <strong>ç•¶å‰ä½¿ç”¨:</strong> {{currentAccount}}
                </div>
            </div>
            <div class="account-grid">
                {{#each accountDetails}}
                <div class="account-card {{statusClass}}">
                    <div class="account-header">
                        <span class="account-name">{{id}}</span>
                        <span class="account-status">{{statusText}}</span>
                    </div>
                    <div class="account-stats">
                        <div class="stat-item">
                            <span>æˆåŠŸç‡:</span>
                            <span>{{successRate}}%</span>
                        </div>
                        <div class="stat-item">
                            <span>ä»Šæ—¥è«‹æ±‚:</span>
                            <span>{{dailyRequests}}</span>
                        </div>
                        <div class="stat-item">
                            <span>é€£çºŒä½¿ç”¨:</span>
                            <span class="{{#if rotationWarning}}rotation-warning{{/if}}">{{consecutiveUses}}/{{rotationThreshold}}</span>
                        </div>
                        <div class="stat-item">
                            <span>æœ€å¾Œä½¿ç”¨:</span>
                            <span>{{lastUsed}}</span>
                        </div>
                        {{#if consecutiveFailures}}
                        <div class="stat-item" style="color: #ff9800;">
                            <span>é€£çºŒå¤±æ•—:</span>
                            <span>{{consecutiveFailures}}</span>
                        </div>
                        {{/if}}
                    </div>
                </div>
                {{/each}}
            </div>
            {{#if invalidCookieAccounts}}
            <div class="account-warning">
                âš ï¸ <strong>æ³¨æ„:</strong> æœ‰ {{invalidCookieAccounts}} å€‹å¸³è™Ÿå·²è¢«åœç”¨ï¼Œå¯èƒ½æ˜¯cookieså¤±æ•ˆã€‚
                è«‹æª¢æŸ¥Discordé€šçŸ¥ç²å–è©³ç´°ä¿®å¾©æŒ‡å¼•ã€‚
            </div>
            {{/if}}
        </div>
        {{/if}}

        {{#if discordChannelCount}}
        <div class="section">
            <div class="section-title">ğŸ“º Discord é »é“ç›£æ§è©³æƒ…</div>
            <div class="channel-stats">
                {{#each channelConfigs}}
                <div class="channel-card">
                    <div class="channel-name">{{name}}</div>
                    <div class="channel-detail">
                        <span>é—œéµå­—:</span>
                        <span>{{keywords}}</span>
                    </div>
                    <div class="channel-detail">
                        <span>è™•ç†è¨Šæ¯:</span>
                        <span>{{messagesProcessed}}</span>
                    </div>
                    <div class="channel-detail">
                        <span>æª¢æ¸¬æ¬¡æ•¸:</span>
                        <span>{{keywordsDetected}}</span>
                    </div>
                    <div class="channel-detail">
                        <span>é€šè©±æ¬¡æ•¸:</span>
                        <span>{{callsMade}}</span>
                    </div>
                    <div class="channel-detail">
                        <span>æœ€å¾Œæª¢æ¸¬:</span>
                        <span>{{lastDetection}}</span>
                    </div>
                </div>
                {{/each}}
            </div>
        </div>
        {{/if}}

        <div class="section">
            <div class="section-title">ğŸ’¬ Discord å‘½ä»¤</div>
            <div class="commands">
                <div class="command">!ig-start - é–‹å§‹Instagramç›£æ§</div>
                <div class="command">!ig-stop - åœæ­¢Instagramç›£æ§</div>
                <div class="command">!ig-status - Instagramç›£æ§ç‹€æ…‹</div>
                <div class="command">!ig-check - æ‰‹å‹•æª¢æŸ¥Instagram</div>
                <div class="command">!ig-accounts - æª¢æŸ¥å¸³è™Ÿç‹€æ…‹</div>
                <div class="command">!status - å®Œæ•´ç³»çµ±ç‹€æ…‹</div>
                <div class="command">!help - é¡¯ç¤ºå¹«åŠ©</div>
            </div>
        </div>

        <div class="refresh-note">
            é é¢æ¯30ç§’è‡ªå‹•åˆ·æ–° | æœ€å¾Œæ›´æ–°: <span id="lastUpdate">{{lastUpdate}}</span><br>
            ğŸ• ç•¶å‰æ—¥æœ¬æ™‚é–“: <span id="currentTime">{{japanTime}}</span> | {{timeSlot}}
        </div>
    </div>

    <script src="/js/status.js"></script>
</body>
</html>